import{K as Ne,l as J,c as k,h as f,A as Y,a4 as xe,a5 as Be,r as E,u as De,a6 as je,p as R,a as de,Q as qe,$ as L,j as V,a7 as Le,a8 as Ue,a9 as Ie,q as Me,v as Qe,aa as We,ab as Ke,ac as Ge,o as Z,ad as he,ae as ge,P as Xe,af as Ze,s as Oe,f as ze,ag as me,ah as Je,ai as Ye,aj as pe,ak as Ve,al as et,am as tt,L as ot,an as nt,X as lt,D as at,Z as it,F as re,_ as ve,I as j,a2 as H,a0 as ce,a3 as ye,ao as rt,ap as be,aq as st,G as ut}from"./index.08ad63da.js";import{Q as ct,u as dt,v as we,a as ft,p as ke,b as ht,c as gt,r as Ce,s as mt,d as Se,e as pt,f as Te,g as vt}from"./QItemSection.8eace9fd.js";import{httpClient as A}from"./axios.b75ae6bc.js";function $e(e,t){if(t&&e===t)return null;const o=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(o)===!0)return e;const n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,i=n.display;return i==="block"||i==="table"?e:$e(e.parentNode)}function se(e,t,o){return!e||e===document.body?!1:o===!0&&e===t||(t===document?document.body:t).contains(e.parentNode)}function He(e,t,o){if(o||(o=document.createRange(),o.selectNode(e),o.setStart(e,0)),t.count===0)o.setEnd(e,t.count);else if(t.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<t.count?t.count-=e.textContent.length:(o.setEnd(e,t.count),t.count=0);else for(let n=0;t.count!==0&&n<e.childNodes.length;n++)o=He(e.childNodes[n],t,o);return o}const yt=/^https?:\/\//;class bt{constructor(t,o){this.el=t,this.eVm=o,this._range=null}get selection(){if(this.el){const t=document.getSelection();if(se(t.anchorNode,this.el,!0)&&se(t.focusNode,this.el,!0))return t}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const t=this.selection;return t!==null&&t.rangeCount?t.getRangeAt(0):this._range}get parent(){const t=this.range;if(t!==null){const o=t.startContainer;return o.nodeType===document.ELEMENT_NODE?o:o.parentNode}return null}get blockParent(){const t=this.parent;return t!==null?$e(t,this.el):null}save(t=this.range){t!==null&&(this._range=t)}restore(t=this._range){const o=document.createRange(),n=document.getSelection();t!==null?(o.setStart(t.startContainer,t.startOffset),o.setEnd(t.endContainer,t.endOffset),n.removeAllRanges(),n.addRange(o)):(n.selectAllChildren(this.el),n.collapseToEnd())}savePosition(){let t=-1,o;const n=document.getSelection(),i=this.el.parentNode;if(n.focusNode&&se(n.focusNode,i))for(o=n.focusNode,t=n.focusOffset;o&&o!==i;)o!==this.el&&o.previousSibling?(o=o.previousSibling,t+=o.textContent.length):o=o.parentNode;this.savedPos=t}restorePosition(t=0){if(this.savedPos>0&&this.savedPos<t){const o=window.getSelection(),n=He(this.el,{count:this.savedPos});n&&(n.collapse(!1),o.removeAllRanges(),o.addRange(n))}}hasParent(t,o){const n=o?this.parent:this.blockParent;return n!==null?n.nodeName.toLowerCase()===t.toLowerCase():!1}hasParents(t,o,n=this.parent){return n===null?!1:t.includes(n.nodeName.toLowerCase())===!0?!0:o===!0?this.hasParents(t,o,n.parentNode):!1}is(t,o){if(this.selection===null)return!1;switch(t){case"formatBlock":return o==="DIV"&&this.parent===this.el||this.hasParent(o,o==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(t)===o;case"fontName":const n=document.queryCommandValue(t);return n===`"${o}"`||n===o;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const i=document.queryCommandState(t);return o!==void 0?i===o:i}}getParentAttribute(t){return this.parent!==null?this.parent.getAttribute(t):null}can(t){if(t==="outdent")return this.hasParents(["blockquote","li"],!0);if(t==="indent")return this.hasParents(["li"],!0);if(t==="link")return this.selection!==null||this.is("link")}apply(t,o,n=Ne){if(t==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(o)&&this.is(t,o)&&(t="outdent",o=null),o==="PRE"&&this.is(t,"PRE")&&(o="P");else if(t==="print"){n();const i=window.open();i.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),i.print(),i.close();return}else if(t==="link"){const i=this.getParentAttribute("href");if(i===null){const s=this.selectWord(this.selection),r=s?s.toString():"";if(!r.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=yt.test(r)?r:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(s.getRangeAt(0))}else this.eVm.editLinkUrl.value=i,this.range.selectNodeContents(this.parent),this.save();return}else if(t==="fullscreen"){this.eVm.toggleFullscreen(),n();return}else if(t==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),n();return}document.execCommand(t,!1,o),n()}selectWord(t){if(t===null||t.isCollapsed!==!0||t.modify===void 0)return t;const o=document.createRange();o.setStart(t.anchorNode,t.anchorOffset),o.setEnd(t.focusNode,t.focusOffset);const n=o.collapsed?["backward","forward"]:["forward","backward"];o.detach();const i=t.focusNode,s=t.focusOffset;return t.collapse(t.anchorNode,t.anchorOffset),t.modify("move",n[0],"character"),t.modify("move",n[1],"word"),t.extend(i,s),t.modify("extend",n[1],"character"),t.modify("extend",n[0],"word"),t}}var wt=J({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=k(()=>{const n=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(i=>e[i]===!0).map(i=>`q-btn-group--${i}`).join(" ");return`q-btn-group row no-wrap${n.length!==0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>f("div",{class:o.value},Y(t.default))}});const kt=Object.keys(xe),Ct=e=>kt.reduce((t,o)=>{const n=e[o];return n!==void 0&&(t[o]=n),t},{});var St=J({name:"QBtnDropdown",props:{...xe,...Be,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:o}){const{proxy:n}=V(),i=E(e.modelValue),s=E(null),r=De(),u=k(()=>{const d={"aria-expanded":i.value===!0?"true":"false","aria-haspopup":"true","aria-controls":r,"aria-label":e.toggleAriaLabel||n.$q.lang.label[i.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(d["aria-disabled"]="true"),d}),m=k(()=>"q-btn-dropdown__arrow"+(i.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),y=k(()=>je(e)),c=k(()=>Ct(e));R(()=>e.modelValue,d=>{s.value!==null&&s.value[d?"show":"hide"]()}),R(()=>e.split,z);function w(d){i.value=!0,o("beforeShow",d)}function p(d){o("show",d),o("update:modelValue",!0)}function h(d){i.value=!1,o("beforeHide",d)}function v(d){o("hide",d),o("update:modelValue",!1)}function b(d){o("click",d)}function x(d){Le(d),z(),o("click",d)}function q(d){s.value!==null&&s.value.toggle(d)}function O(d){s.value!==null&&s.value.show(d)}function z(d){s.value!==null&&s.value.hide(d)}return Object.assign(n,{show:O,hide:z,toggle:q}),de(()=>{e.modelValue===!0&&O()}),()=>{const d=[f(qe,{class:m.value,name:e.dropdownIcon||n.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&d.push(f(ct,{ref:s,id:r,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:w,onShow:p,onBeforeHide:h,onHide:v},t.default)),e.split===!1?f(L,{class:"q-btn-dropdown q-btn-dropdown--simple",...c.value,...u.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:b},{default:()=>Y(t.label,[]).concat(d),loading:t.loading}):f(wt,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...y.value,glossy:e.glossy,stretch:e.stretch},()=>[f(L,{class:"q-btn-dropdown--current",...c.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:x},{default:t.label,loading:t.loading}),f(L,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...u.value,...y.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>d)])}}}),Tt=J({name:"QTooltip",inheritAttrs:!1,props:{...dt,...Ue,...Be,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:we},self:{type:String,default:"top middle",validator:we},offset:{type:Array,default:()=>[14,14],validator:ft},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Ie],setup(e,{slots:t,emit:o,attrs:n}){let i,s;const r=V(),{proxy:{$q:u}}=r,m=E(null),y=E(!1),c=k(()=>ke(e.anchor,u.lang.rtl)),w=k(()=>ke(e.self,u.lang.rtl)),p=k(()=>e.persistent!==!0),{registerTick:h,removeTick:v}=Me(),{registerTimeout:b}=Qe(),{transitionProps:x,transitionStyle:q}=We(e),{localScrollTarget:O,changeScrollEvent:z,unconfigureScrollTarget:d}=ht(e,K),{anchorEl:B,canShow:I,anchorEvents:C}=gt({showing:y,configureAnchorEl:ie}),{show:ee,hide:D}=Ke({showing:y,canShow:I,handleShow:oe,handleHide:ne,hideOnRouteChange:p,processOnMount:!0});Object.assign(C,{delayShow:le,delayHide:ae});const{showPortal:M,hidePortal:Q,renderPortal:te}=Ge(r,m,X,"tooltip");if(u.platform.is.mobile===!0){const S={anchorEl:B,innerRef:m,onClickOutside(P){return D(P),P.target.classList.contains("q-dialog__backdrop")&&Oe(P),!0}},_=k(()=>e.modelValue===null&&e.persistent!==!0&&y.value===!0);R(_,P=>{(P===!0?pt:Ce)(S)}),Z(()=>{Ce(S)})}function oe(S){M(),h(()=>{s=new MutationObserver(()=>F()),s.observe(m.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),F(),K()}),i===void 0&&(i=R(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,F)),b(()=>{M(!0),o("show",S)},e.transitionDuration)}function ne(S){v(),Q(),W(),b(()=>{Q(!0),o("hide",S)},e.transitionDuration)}function W(){s!==void 0&&(s.disconnect(),s=void 0),i!==void 0&&(i(),i=void 0),d(),he(C,"tooltipTemp")}function F(){mt({targetEl:m.value,offset:e.offset,anchorEl:B.value,anchorOrigin:c.value,selfOrigin:w.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function le(S){if(u.platform.is.mobile===!0){Se(),document.body.classList.add("non-selectable");const _=B.value,P=["touchmove","touchcancel","touchend","click"].map(N=>[_,N,"delayHide","passiveCapture"]);ge(C,"tooltipTemp",P)}b(()=>{ee(S)},e.delay)}function ae(S){u.platform.is.mobile===!0&&(he(C,"tooltipTemp"),Se(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),b(()=>{D(S)},e.hideDelay)}function ie(){if(e.noParentEvent===!0||B.value===null)return;const S=u.platform.is.mobile===!0?[[B.value,"touchstart","delayShow","passive"]]:[[B.value,"mouseenter","delayShow","passive"],[B.value,"mouseleave","delayHide","passive"]];ge(C,"anchor",S)}function K(){if(B.value!==null||e.scrollTarget!==void 0){O.value=Xe(B.value,e.scrollTarget);const S=e.noParentEvent===!0?F:D;z(O.value,S)}}function G(){return y.value===!0?f("div",{...n,ref:m,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,q.value],role:"tooltip"},Y(t.default)):null}function X(){return f(Ze,x.value,G)}return Z(W),Object.assign(r.proxy,{updatePosition:F}),te}});function Ae(e,t,o){t.handler?t.handler(e,o,o.caret):o.runCmd(t.cmd,t.param)}function fe(e){return f("div",{class:"q-editor__toolbar-group"},e)}function Ee(e,t,o,n=!1){const i=n||(t.type==="toggle"?t.toggled?t.toggled(e):t.cmd&&e.caret.is(t.cmd,t.param):!1),s=[];if(t.tip&&e.$q.platform.is.desktop){const r=t.key?f("div",[f("small",`(CTRL + ${String.fromCharCode(t.key)})`)]):null;s.push(f(Tt,{delay:1e3},()=>[f("div",{innerHTML:t.tip}),r]))}return f(L,{...e.buttonProps.value,icon:t.icon!==null?t.icon:void 0,color:i?t.toggleColor||e.props.toolbarToggleColor:t.color||e.props.toolbarColor,textColor:i&&!e.props.toolbarPush?null:t.textColor||e.props.toolbarTextColor,label:t.label,disable:t.disable?typeof t.disable=="function"?t.disable(e):!0:!1,size:"sm",onClick(r){o&&o(),Ae(r,t,e)}},()=>s)}function Pt(e,t){const o=t.list==="only-icons";let n=t.label,i=t.icon!==null?t.icon:void 0,s,r;function u(){y.component.proxy.hide()}if(o)r=t.options.map(c=>{const w=c.type===void 0?e.caret.is(c.cmd,c.param):!1;return w&&(n=c.tip,i=c.icon!==null?c.icon:void 0),Ee(e,c,u,w)}),s=e.toolbarBackgroundClass.value,r=[fe(r)];else{const c=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,w=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,p=t.list==="no-icons";r=t.options.map(h=>{const v=h.disable?h.disable(e):!1,b=h.type===void 0?e.caret.is(h.cmd,h.param):!1;b&&(n=h.tip,i=h.icon!==null?h.icon:void 0);const x=h.htmlTip;return f(vt,{active:b,activeClass:c,clickable:!0,disable:v,dense:!0,onClick(q){u(),e.contentRef.value!==null&&e.contentRef.value.focus(),e.caret.restore(),Ae(q,h,e)}},()=>[p===!0?null:f(Te,{class:b?c:w,side:!0},()=>f(qe,{name:h.icon!==null?h.icon:void 0})),f(Te,x?()=>f("div",{class:"text-no-wrap",innerHTML:h.htmlTip}):h.tip?()=>f("div",{class:"text-no-wrap"},h.tip):void 0)])}),s=[e.toolbarBackgroundClass.value,w]}const m=t.highlight&&n!==t.label,y=f(St,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:m?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:m&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:t.fixedLabel?t.label:n,icon:t.fixedIcon?t.icon!==null?t.icon:void 0:i,contentClass:s,onShow:c=>e.emit("dropdownShow",c),onHide:c=>e.emit("dropdownHide",c),onBeforeShow:c=>e.emit("dropdownBeforeShow",c),onBeforeHide:c=>e.emit("dropdownBeforeHide",c)},()=>r);return y}function xt(e){if(e.caret)return e.buttons.value.filter(t=>!e.isViewingSource.value||t.find(o=>o.cmd==="viewsource")).map(t=>fe(t.map(o=>e.isViewingSource.value&&o.cmd!=="viewsource"?!1:o.type==="slot"?Y(e.slots[o.slot]):o.type==="dropdown"?Pt(e,o):Ee(e,o))))}function Bt(e,t,o,n={}){const i=Object.keys(n);if(i.length===0)return{};const s={default_font:{cmd:"fontName",param:e,icon:o,tip:t}};return i.forEach(r=>{const u=n[r];s[r]={cmd:"fontName",param:u,icon:o,tip:u,htmlTip:`<font face="${u}">${u}</font>`}}),s}function qt(e){if(e.caret){const t=e.props.toolbarColor||e.props.toolbarTextColor;let o=e.editLinkUrl.value;const n=()=>{e.caret.restore(),o!==e.editLinkUrl.value&&document.execCommand("createLink",!1,o===""?" ":o),e.editLinkUrl.value=null};return[f("div",{class:`q-mx-xs text-${t}`},`${e.$q.lang.editor.url}: `),f("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:o,onInput:i=>{Le(i),o=i.target.value},onKeydown:i=>{if(ze(i)!==!0)switch(i.keyCode){case 13:return me(i),n();case 27:me(i),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),fe([f(L,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),f(L,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:n})])]}}let U=0;const Lt={fullscreen:Boolean,noRouteFullscreenExit:Boolean},Ot=["update:fullscreen","fullscreen"];function zt(){const e=V(),{props:t,emit:o,proxy:n}=e;let i,s,r;const u=E(!1);Je(e)===!0&&R(()=>n.$route.fullPath,()=>{t.noRouteFullscreenExit!==!0&&c()}),R(()=>t.fullscreen,w=>{u.value!==w&&m()}),R(u,w=>{o("update:fullscreen",w),o("fullscreen",w)});function m(){u.value===!0?c():y()}function y(){u.value!==!0&&(u.value=!0,r=n.$el.parentNode,r.replaceChild(s,n.$el),document.body.appendChild(n.$el),U++,U===1&&document.body.classList.add("q-body--fullscreen-mixin"),i={handler:c},pe.add(i))}function c(){u.value===!0&&(i!==void 0&&(pe.remove(i),i=void 0),r.replaceChild(n.$el,s),u.value=!1,U=Math.max(0,U-1),U===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),n.$el.scrollIntoView!==void 0&&setTimeout(()=>{n.$el.scrollIntoView()})))}return Ye(()=>{s=document.createElement("span")}),de(()=>{t.fullscreen===!0&&y()}),Z(c),Object.assign(n,{toggleFullscreen:m,setFullscreen:y,exitFullscreen:c}),{inFullscreen:u,toggleFullscreen:m}}const $t=Object.prototype.toString,ue=Object.prototype.hasOwnProperty,Ht=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function Pe(e){if(e!==Object(e)||Ht.has($t.call(e))===!0||e.constructor&&ue.call(e,"constructor")===!1&&ue.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let t;for(t in e);return t===void 0||ue.call(e,t)}function Re(){let e,t,o,n,i,s,r=arguments[0]||{},u=1,m=!1;const y=arguments.length;for(typeof r=="boolean"&&(m=r,r=arguments[1]||{},u=2),Object(r)!==r&&typeof r!="function"&&(r={}),y===u&&(r=this,u--);u<y;u++)if((e=arguments[u])!==null)for(t in e)o=r[t],n=e[t],r!==n&&(m===!0&&n&&((i=Array.isArray(n))||Pe(n)===!0)?(i===!0?s=Array.isArray(o)===!0?o:[]:s=Pe(o)===!0?o:{},r[t]=Re(m,s,n)):n!==void 0&&(r[t]=n));return r}var At=J({name:"QEditor",props:{...Ve,...Lt,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(t=>t.length),default(){return[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]}},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...Ot,"update:modelValue","keydown","click","mouseup","keyup","touchend","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:t,emit:o,attrs:n}){const{proxy:i,vnode:s}=V(),{$q:r}=i,u=et(e,r),{inFullscreen:m,toggleFullscreen:y}=zt(),c=tt(n,s),w=E(null),p=E(null),h=E(null),v=E(!1),b=k(()=>!e.readonly&&!e.disable);let x,q,O=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),x=window.getComputedStyle(document.body).fontFamily;const z=k(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),d=k(()=>{const l=e.toolbarOutline!==!0&&e.toolbarPush!==!0;return{type:"a",flat:l,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!b.value,size:"sm"}}),B=k(()=>{const l=r.lang.editor,a=r.iconSet.editor;return{bold:{cmd:"bold",icon:a.bold,tip:l.bold,key:66},italic:{cmd:"italic",icon:a.italic,tip:l.italic,key:73},strike:{cmd:"strikeThrough",icon:a.strikethrough,tip:l.strikethrough,key:83},underline:{cmd:"underline",icon:a.underline,tip:l.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:a.unorderedList,tip:l.unorderedList},ordered:{cmd:"insertOrderedList",icon:a.orderedList,tip:l.orderedList},subscript:{cmd:"subscript",icon:a.subscript,tip:l.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:a.superscript,tip:l.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:g=>g.caret&&!g.caret.can("link"),icon:a.hyperlink,tip:l.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:a.toggleFullscreen,tip:l.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:a.viewSource,tip:l.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:a.quote,tip:l.quote,key:81},left:{cmd:"justifyLeft",icon:a.left,tip:l.left},center:{cmd:"justifyCenter",icon:a.center,tip:l.center},right:{cmd:"justifyRight",icon:a.right,tip:l.right},justify:{cmd:"justifyFull",icon:a.justify,tip:l.justify},print:{type:"no-state",cmd:"print",icon:a.print,tip:l.print,key:80},outdent:{type:"no-state",disable:g=>g.caret&&!g.caret.can("outdent"),cmd:"outdent",icon:a.outdent,tip:l.outdent},indent:{type:"no-state",disable:g=>g.caret&&!g.caret.can("indent"),cmd:"indent",icon:a.indent,tip:l.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:a.removeFormat,tip:l.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:a.hr,tip:l.hr},undo:{type:"no-state",cmd:"undo",icon:a.undo,tip:l.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:a.redo,tip:l.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:a.heading1||a.heading,tip:l.heading1,htmlTip:`<h1 class="q-ma-none">${l.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:a.heading2||a.heading,tip:l.heading2,htmlTip:`<h2 class="q-ma-none">${l.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:a.heading3||a.heading,tip:l.heading3,htmlTip:`<h3 class="q-ma-none">${l.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:a.heading4||a.heading,tip:l.heading4,htmlTip:`<h4 class="q-ma-none">${l.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:a.heading5||a.heading,tip:l.heading5,htmlTip:`<h5 class="q-ma-none">${l.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:a.heading6||a.heading,tip:l.heading6,htmlTip:`<h6 class="q-ma-none">${l.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:a.heading,tip:l.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:a.code,htmlTip:`<code>${l.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:a.size1||a.size,tip:l.size1,htmlTip:`<font size="1">${l.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:a.size2||a.size,tip:l.size2,htmlTip:`<font size="2">${l.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:a.size3||a.size,tip:l.size3,htmlTip:`<font size="3">${l.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:a.size4||a.size,tip:l.size4,htmlTip:`<font size="4">${l.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:a.size5||a.size,tip:l.size5,htmlTip:`<font size="5">${l.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:a.size6||a.size,tip:l.size6,htmlTip:`<font size="6">${l.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:a.size7||a.size,tip:l.size7,htmlTip:`<font size="7">${l.size7}</font>`}}}),I=k(()=>{const l=e.definitions||{},a=e.definitions||e.fonts?Re(!0,{},B.value,l,Bt(x,r.lang.editor.defaultFont,r.iconSet.editor.font,e.fonts)):B.value;return e.toolbar.map(g=>g.map(T=>{if(T.options)return{type:"dropdown",icon:T.icon,label:T.label,size:"sm",dense:!0,fixedLabel:T.fixedLabel,fixedIcon:T.fixedIcon,highlight:T.highlight,list:T.list,options:T.options.map(_e=>a[_e])};const $=a[T];return $?$.type==="no-state"||l[T]&&($.cmd===void 0||B.value[$.cmd]&&B.value[$.cmd].type==="no-state")?$:Object.assign({type:"toggle"},$):{type:"slot",slot:T}}))}),C={$q:r,props:e,slots:t,emit:o,inFullscreen:m,toggleFullscreen:y,runCmd:_,isViewingSource:v,editLinkUrl:h,toolbarBackgroundClass:z,buttonProps:d,contentRef:p,buttons:I,setContent:S};R(()=>e.modelValue,l=>{O!==l&&(O=l,S(l,!0))}),R(h,l=>{o(`link${l?"Show":"Hide"}`)});const ee=k(()=>e.toolbar&&e.toolbar.length!==0),D=k(()=>{const l={},a=g=>{g.key&&(l[g.key]={cmd:g.cmd,param:g.param})};return I.value.forEach(g=>{g.forEach(T=>{T.options?T.options.forEach(a):a(T)})}),l}),M=k(()=>m.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),Q=k(()=>`q-editor q-editor--${v.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(m.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(u.value===!0?" q-editor--dark q-dark":"")),te=k(()=>[e.contentClass,"q-editor__content",{col:m.value,"overflow-auto":m.value||e.maxHeight}]),oe=k(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});function ne(){if(p.value!==null){const l=`inner${v.value===!0?"Text":"HTML"}`,a=p.value[l];a!==e.modelValue&&(O=a,o("update:modelValue",a))}}function W(l){if(o("keydown",l),l.ctrlKey!==!0||ze(l)===!0){P();return}const a=l.keyCode,g=D.value[a];if(g!==void 0){const{cmd:T,param:$}=g;Oe(l),_(T,$,!1)}}function F(l){P(),o("click",l)}function le(l){if(p.value!==null){const{scrollTop:a,scrollHeight:g}=p.value;q=g-a}C.caret.save(),o("blur",l)}function ae(l){ot(()=>{p.value!==null&&q!==void 0&&(p.value.scrollTop=p.value.scrollHeight-q)}),o("focus",l)}function ie(l){const a=w.value;if(a!==null&&a.contains(l.target)===!0&&(l.relatedTarget===null||a.contains(l.relatedTarget)!==!0)){const g=`inner${v.value===!0?"Text":"HTML"}`;C.caret.restorePosition(p.value[g].length),P()}}function K(l){const a=w.value;a!==null&&a.contains(l.target)===!0&&(l.relatedTarget===null||a.contains(l.relatedTarget)!==!0)&&(C.caret.savePosition(),P())}function G(){q=void 0}function X(l){C.caret.save()}function S(l,a){if(p.value!==null){a===!0&&C.caret.savePosition();const g=`inner${v.value===!0?"Text":"HTML"}`;p.value[g]=l,a===!0&&(C.caret.restorePosition(p.value[g].length),P())}}function _(l,a,g=!0){N(),C.caret.restore(),C.caret.apply(l,a,()=>{N(),C.caret.save(),g&&P()})}function P(){setTimeout(()=>{h.value=null,i.$forceUpdate()},1)}function N(){nt(()=>{p.value!==null&&p.value.focus({preventScroll:!0})})}function Fe(){return p.value}return de(()=>{C.caret=i.caret=new bt(p.value,C),S(e.modelValue),P(),document.addEventListener("selectionchange",X)}),Z(()=>{document.removeEventListener("selectionchange",X)}),Object.assign(i,{runCmd:_,refreshToolbar:P,focus:N,getContentEl:Fe}),()=>{let l;if(ee.value){const a=[f("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+z.value},xt(C))];h.value!==null&&a.push(f("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+z.value},qt(C))),l=f("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},a)}return f("div",{ref:w,class:Q.value,style:{height:m.value===!0?"100%":null},...oe.value,onFocusin:ie,onFocusout:K},[l,f("div",{ref:p,style:M.value,class:te.value,contenteditable:b.value,placeholder:e.placeholder,...c.listeners.value,onInput:ne,onKeydown:W,onClick:F,onBlur:le,onFocus:ae,onMousedown:G,onTouchstartPassive:G})])}}});const Et=lt("write",{state:()=>({text:"",title:"",filepaths:[],filenames:[],selectedFile:"",illegal:!1,spaceCount:0}),actions:{async save(e,t,o){const n={content:e,title:t,filename:o},i=await A.post("/save",n);this.selectedFile=i.data,this.loadAll()},async getSelectedFile(e){const t=new URLSearchParams({filename:e}),o=await A.get("/getSelectedFile",{params:t});this.selectedFile=o.data},async load(e){const t=new URLSearchParams({filepath:e}),o=await A.get("/loadText",{params:t}),n=await A.get("/loadFilename",{params:t});this.text=o.data,this.title=n.data},async loadAll(){const e=await A.get("/loadFiles"),t=await A.get("/loadFilenames");this.filepaths=e.data,this.filenames=t.data},async firstLoadAll(){await this.loadAll(),this.selectedFile=this.filepaths[0],this.load(this.selectedFile)},async delete(e){const t=new URLSearchParams({filepath:e});await A.delete("/delete",{params:t}),this.loadAll()},async checkChars(e){const t=new URLSearchParams({fileTitle:e}),o=new URLSearchParams({fileTitle:e}),n=await A.get("/checkChars",{params:t}),i=await A.get("/checkSpaceChars",{params:o});this.illegal=n.data,this.spaceCount=i.data}}}),Rt=ce("div",{class:"row no-wrap"},[ce("div",{style:{"min-width":"424px"}})],-1),Ft={style:{"min-width":"424px"}},jt=at({__name:"WritingPage",setup(e){const t=Et(),{text:o,title:n,filepaths:i,filenames:s,selectedFile:r,illegal:u,spaceCount:m}=it(t);t.firstLoadAll();async function y(){await t.checkChars(n.value),u.value?alert(`Sorry! A file name can't contain any of the following characters: 
 \\ / : * ? " < > |`):m.value===n.value.length?alert("Sorry! A blank space is not a title!"):t.save(o.value,n.value,r.value)}async function c(h){await t.getSelectedFile(h),await t.load(r.value)}function w(){o.value="",n.value="Untitled",r.value=""}function p(){var h=confirm(`Are you sure you want to delete this chapter? 
This action cannot be undone.`);h&&(t.delete(r.value),n.value="",o.value="",r.value="")}return(h,v)=>(re(),ve(ye,null,[Rt,j(L,{style:{color:"white","background-color":"hotpink"},icon:"save",disable:!H(n),onClick:v[0]||(v[0]=b=>y())},null,8,["disable"]),j(L,{style:{color:"white","background-color":"hotpink"},label:"Create",onClick:v[1]||(v[1]=b=>w())}),j(L,{style:{color:"white","background-color":"hotpink"},label:"Delete",disable:!H(r),onClick:v[2]||(v[2]=b=>p())},null,8,["disable"]),ce("div",Ft,[(re(!0),ve(ye,null,rt(H(i),(b,x)=>(re(),ut(L,{key:x,modelValue:H(i)[x],"onUpdate:modelValue":q=>H(i)[x]=q,label:H(s)[x],onClick:q=>c(H(i)[x])},null,8,["modelValue","onUpdate:modelValue","label","onClick"]))),128))]),j(st,{modelValue:H(n),"onUpdate:modelValue":v[3]||(v[3]=b=>be(n)?n.value=b:null),label:"Title"},null,8,["modelValue"]),j(At,{modelValue:H(o),"onUpdate:modelValue":v[4]||(v[4]=b=>be(o)?o.value=b:null),"min-height":"30rem"},null,8,["modelValue"])],64))}});export{jt as default};
